<?php include(APPPATH."views/layouts/logged_header.phtml");?>
            <!-- NAVIGATION SECTION -->
      <?php include(APPPATH."views/layouts/nav.phtml");?>
      <!-- /NAVIGATION SECTION -->
      </div>
</div>
<!-- /HEADER SECTION -->
<div class="clr"></div>
<!-- CONTENT SECTION -->
<div id="content_section">
      <div id="container">
            <div id="mid_content">
                  <!-- latest news -->
                  <?php include(APPPATH ."views/layouts/latest_news.phtml");?>
                  <!-- /latest news -->
                  <div class="clr"></div>
                  <!-- main container -->
                  <div id="main_container">
                        <!--buttons section start -->
                        <?php include(APPPATH ."views/logged/holy_place/prayer_wall/prayer_wall_menu.phtml");?>
                        <div class="clr"></div>
                        <!--buttons section end -->
                        
                        <!--search prayer wall, create prayer request tab start -->
                        <div class="search-create-prayer-container">
                        	<h2 class="title">View All Prayer Request</h2>
                        	<ul class="search-create-btn-holder">
                            	<li><a href="javascript:void(0);">Search Prayer Wall</a></li>
                                <li><a href="javascript:void(0);">Create new prayer request</a></li>
                            </ul>
                            <div class="clr"></div>
                            
                            <div class="search-create-form-container">
                            	<!--search form start -->
                                <div class="frm_box search-create-prayer-box">
                                <!--minimize link start -->
                                    <div class="minimize" title="Minimize">&nbsp;</div>
                                <!--minimize link end -->
                                
                                    <form id="frm_Search" action="" method="post" enctype="multipart/form-data" onsubmit="return false;">
                                      <div class="lable01" style=" width:100px;">Country:</div>
                                      <div class="field04">
                                         <select name="txt_srch_country" id="txt_srch_country"  style="width:212px;"/>
										 <option value="-1">Select</option>
                     					 <?=makeOptionCountry();?>
                                         </select>
                                      </div>
                                      
                                      
                                      
                                      
                                      <div class="lable01" style=" width:100px;">State:</div>
                                      <div class="field04">
                                            <input name="txt_srch_state" id="txt_srch_state" type="text" />
                                      </div>
                                      <div class="clr"></div>
                                      <div class="lable01" style=" width:100px;">City:</div>
                                      <div class="field04">
                                            <input name="txt_srch_city" id="txt_srch_city" type="text" />
                                      </div>
                                      
                                      <div class="lable01" style=" width:100px;">Request Type:</div>
                                      <div class="field04">
                                            <select name="srch_request_type" id="srch_request_type" style="width:212px;">
                                            	
                                                  <option value="-1">Select</option>
                                                  <option value="1">Emergency</option>
                                                  <option value="2">On Going</option>
                                            </select>
                                           <?php /*?> <script type="text/javascript">
                                                $(document).ready(function(arg) {
                                                    $("#srch_request_type").msDropDown();
                                                    $("#srch_request_type").hide();
                                                })
                                            </script><?php */?>
                                      </div>
                                      <div class="clr"></div>
                                     
                                      <div class="lable01" style=" width:100px;">Time:</div>
                                      <div class="field04">
                                            <div class="lbl01" style=" width:38px;"> From:</div>
                                            <div class="lbl01" style=" width:165px;">
                                                 <input name="txt_srch_from_time" id="txt_srch_from_time" type="text" style="width:155px;" />
                                            </div>
                                      </div>
                                      
                                      <div class="lable01" style=" width:100px;">Date:</div>
                                      <div class="field04">
                                            <input style="width:170px;"   type="text"  value="" name="srch_date_to" id="srch_date_to"  readonly="readonly"/>
                                            <img src="images/icons/cal.png" alt="" onclick="$(this).prev().focus()" style="cursor:pointer; " />
                                            <script type="text/javascript">
                                                    $(document).ready(function(arg) {
                                                       // $.datepicker.setDefaults($.datepicker.regional['']);
                                                        $("#srch_date_to").datepicker($.datepicker.regional['en']);
                        
                                                    });
                                                </script>
                                      </div>
                                      <div class="clr"></div>
                                      
                                      
                                      <div class="lable01" style=" width:100px;"></div>
                                      <div class="field04">
                                            <div class="lbl01" style=" width:38px;"> To:</div>
                                            <div class="lbl01" style=" width:165px;">
                                                 <input name="txt_srch_to_time" id="txt_srch_to_time" type="text" style="width:155px;" />
                                            </div>
                                      </div>
                                      
                                      
                                      <div class="lable01" style=" width:100px;">Date:</div>
                                      <div class="field04">
                                            <input style="width:170px;"   type="text"  value="" name="srch_date_end" id="srch_date_end"  readonly="readonly"/>
                                            <img src="images/icons/cal.png" alt="" onclick="$(this).prev().focus()" style="cursor:pointer; " />
                                            <script type="text/javascript">
                                                    $(document).ready(function(arg) {
                                                       // $.datepicker.setDefaults($.datepicker.regional['']);
                                                        $("#srch_date_end").datepicker($.datepicker.regional['en']);
														
                        
                                                    });
                                                </script>
                                      </div>
                                      <div class="clr"></div>
                                      
                                      <div class="lable01" style=" width:100px;">&nbsp;</div>
                                      <div class="field04">
                                      		<input type="hidden" id="search_basic" name="search_basic" value="Y"/>
                                            <input name="" type="submit" value="Search"  class="blue-small-button"/>
                                      </div>
                                      <div class="clr"></div>
                                	</form>
                                </div>
                                <!--search form end -->
                                
                                <!--create new prayer request start -->
                                <div class="frm_box search-create-prayer-box" id="create_box">
                                	
                                     <!--minimize link start -->
                                    <div class="minimize" title="Minimize">&nbsp;</div>
                               		 <!--minimize link end -->
                                    <form id="add_prayer_request" action="<?=base_url().'logged/prayer_wall/add_prayer_request_ajax'?>" onsubmit="return false;" method="post" enctype="multipart/form-data">
                                      <div class="lable01" style=" width:100px;">Request Type:</div>
                                      <div class="field04">
                                             <select name="request_type" id="request_type" style="width:212px;">
                                            	
                                                  <option value="-1">Select</option>
                                                  <option value="1">Emergency</option>
                                                  <option value="2">On Going</option>
                                            </select>
                                          <?php /*?>  <script type="text/javascript">
                                                $(document).ready(function(arg) {
                                                    $("#request_type").msDropDown();
                                                    $("#request_type").hide();
                                                })
                                            </script><?php */?>
                                           <span id="err_request_type" class="error-message"></span>  
                                      </div>
                                      <div class="clr"></div>
                                      <?php /*?><div class="lable01" style=" width:100px;">Subject:</div>
                                      <div class="field04">
                                            <input name="txt_subject" id="txt_subject" type="text" />
                                            <span id="err_subject" class="error-message"></span>  
                                      </div>
                                      <div class="clr"></div><?php */?>
                                      <div class="lable01" style=" width:100px;">Description:</div>
                                      <div class="field03">
                                            <textarea name="ta_desc"  id="ta_desc" style="width:435px; height:80px;" onFocus="if(this.value=='Max 300 Char allowed')this.value='';" onBlur="if(this.value=='')this.value='Max 300 Char allowed';" >Max 300 Char allowed</textarea>
                                            <span id="err_desc" class="error-message"></span>  
                                      </div>
                                      <div class="clr"></div>
                                      
                                      <div class="lable01" style=" width:100px;">&nbsp;</div>
                                      <div class="field03" style="width:0px;">
                                          <input name="" type="button" value="Add Photo"  class="blue-small-button" onclick="return show_dialog('contact_div')"/> <span id="err_image_msg" class="error-message"></span>
                                     
                                          <img id="uploaded_img" src="" alt="" style="display: none;">
                                   		 <p id="photo_name" style=" width:100px;"></p>
                                      </div>
                                       
                                      <div class="clr"></div>
                                      
                                      <div class="lable01" style=" width:100px;">Date:</div>
                                      <div class="field03" style="width:500px;">
                                            <div class="lbl01" style=" width:38px;"> From:</div>
                                            
                                            <div class="lbl01"  style=" width:180px;">
                                                  <input style="width:150px; float:left;"   type="text"  value="" name="date_to1" id="date_to1"  readonly="readonly"/>
                                                  <img src="images/icons/cal.png" alt="" class="right" onclick="$(this).prev().focus()" style="cursor:pointer; " />
                                                  <script type="text/javascript">
                                                    $(document).ready(function(arg) {
                                                        //$.datepicker.setDefaults($.datepicker.regional['']);
                                                        //$("#date_to1").datepicker($.datepicker.regional['en']);
														dateToday = new Date(); 
														$("#date_to1").datepicker({minDate: dateToday});
                        								/*var d = new Date(); 
														d.setDate( d.getDate() + 1 );
														$('#date_to1').datepicker('setDate', d); 
														d = new Date(); d.setDate( d.getDate() + 4 );
														$('#date_end1').datepicker({minDate: d});*/
														
														
                                                    });
                                                </script>
                                                 <span id="err_date_to1" class="error-message"></span>  
                                            </div>
                                            
                                            <div class="lbl01" style=" width:40px;">Time:</div>
                                            <div class="lbl01" style=" width:165px;">
                                                 <input name="txt_from_time" id="txt_from_time" type="text" style="width:155px;" />
                                                 <span style="font-weight: normal;font-size: 11px;font-style: italic;">(24-hour format ex : HH:MM)</span>
                                                 <span id="err_from_time" class="error-message"></span>  
                                            </div>
                                           
                                      </div>
                                      <div class="clr"></div>
                                      <div class="lable01" style=" width:100px;"></div>
                                      <div class="field03" style="width:460px;">
                                            <div class="lbl01" style=" width:38px;"> To:</div>
                                            <div class="lbl01"  style=" width:180px;">
                                                    <input style="width:150px; float:left;"  type="text"  value="" name="date_end1" id="date_end1"  readonly="readonly"/>
                                            <img src="images/icons/cal.png" class="right" alt="" onclick="$(this).prev().focus()" style="cursor:pointer; " />
                                              <script type="text/javascript">
                                                    $(document).ready(function(arg) {
                                                       // $.datepicker.setDefaults($.datepicker.regional['']);
                                                       // $("#date_end1").datepicker($.datepicker.regional['en']);
                        								//$("#date_end1").datepicker({minDate: new Date(<?=(date('Y'))?>, <?=(date('m')-1)?>, <?=(date('d'))?>, 0, 00)});
														 dateToday = new Date(); 
														$("#date_end1").datepicker({minDate: dateToday});

                                                    });
                                                </script>
                                                <span id="err_date_end1" class="error-message"></span>  
                                            </div>
                                          
                                            <div class="lbl01" style=" width:40px;">Time:</div>
                                            <div class="lbl01" style=" width:165px;">
                                                   <input name="txt_to_time" id="txt_to_time" type="text" style="width:155px;" />
                                                   <span style="font-weight: normal;font-size: 11px;font-style: italic;">(24-hour format ex : HH:MM)</span>
                                                   <span id="err_to_time" class="error-message"></span>  
                                            </div>
                                            
                                            
                                            
                                            
                                      </div>
                                     <div class="field01">It expires on end date</div>
                          			 <input name="hd_image_name" id="hd_image_name" type="hidden"/>
                                     
                                      <div class="clr"></div>
                                      <div class="lable01" style=" width:100px;">&nbsp;</div>
                                      <div class="field04">
                                            <input name="" type="submit" value="Post"  class="blue-small-button"/>
                                      </div>
                                      <div class="clr"></div>
                                   </form>
                                </div>
                                <!--create new prayer request start -->
                            </div>
                        </div>
                        <!--search prayer wall, create prayer request tab end -->
                        
					<DIV id="req_content_div"><?=$prayer_req_ajax_content?></DIV>                       
                        
                  </div>
                  <!-- /main container -->
                  <!--pagination start -->
                         <div class="clr"></div> 
                          <?php if($no_of_result  == 0):?>
                                <div class="shade_box_01" style="padding-top:5px;" id="no_tweets"><div  class="shade_norecords" style="width:520px;;"><p class="blue_bold12">No Prayer Request.</p></div></div>
                            <?php endif;?>	
                           
                            
                            <?php if($no_of_result > $pagination_per_page): ?>
                                    
                                    <div class="view_more" id="show_more_div"><a href="javascript:void(0);" id="show_more_tweets_link" page_value="<?=$current_page_1?>" onclick="show_more_records($(this).attr('page_value'))">[view more] </a> </div>
                            <?php endif; ?>
                  <!--pagination end -->
                  
            </div>
      </div>
      <div class="clr"></div>
</div>
<!-- /CONTENT SECTION -->
<div class="clr"></div>
<!-- FOOTER SECTION -->
<?php include(APPPATH."views/layouts/footer.phtml");?>
<?php include(APPPATH."views/logged/blocks/common_popup.phtml");?>
<!-- /FOOTER SECTION -->


<div class="lightbox contact_div" style="width:500px; ">
      <div class="close"><a href="javascript:void(0)" onclick="hide_dialog()"><img src="images/close.png" alt="" /></a></div>
      <div class="top">
            <div>&nbsp;</div>
      </div>
      <div class="mid">
            <div class="heading" style="margin-bottom:0px;">
                  <div class="left">
                        <h4>Select from prayer wall photos </h4>
                  </div>
            </div>
               <div class="shade_box_white" style="padding:8px 0px;">
                 
                  
                  <div id="contact_list" >
                                   
                                      <div class="selectRecipients" style="background-color: #FFF; width:457px; border:none;">
                                       <?php 
										  if(count($prayer_photo)):
											 $count_total = 1;
											 //pr($contact_arr);
											  foreach($prayer_photo as $key=>$val){
												  
												 
												  $IMG = base_url()."uploads/prayer_wall_photos/".getThumbName($val['s_photo_name'],'thumb'); 
												  $CSS = ($count_total%4 == 0)?'no-right-mrgn':'';
														
										 ?>
                                         <div class="image-block <?=$CSS?>">
                                             
                                              <input type="radio" name="prayer_img_name" value="<?=$val['s_photo_name']?>" thumb="<?=base_url()."uploads/prayer_wall_photos/".getThumbName($val['s_photo_name'],'mid');?>"/>
                                              <div class="inside">
                                                
                                                  <img alt="Prayer photo" src="<?=$IMG?>"><br/><br/><br/>
                                                  
                                              </div>
                                          </div>
                                        
                                       	 
										 <?php	$count_total++;	
										 			}
										 		endif; 
										 ?>
                                       	   
                                	  </div> 
								</div>
                    <div class="clr"></div>
                    <br />
                    <div style="text-align:right;"><input name="" type="button" value="Done" onclick="javascript:get_selected_photo();" class="btn"/></div>
            </div>
            
      </div>
      <div class="bot">
            <div>&nbsp;</div>
      </div>
</div>


<script type="text/javascript">

$(document).ready(function () {


 //counting the left characters in comment
     function limitChars(textid, limit, infodiv)
     {
      var text = $('#'+textid).val(); 
      var textlength = text.length;
      if(textlength > limit)
      {
      $('#'+textid).val(text.substr(0,limit));
       return false;
      }
      else
      {
      
       return true;
      }
     }
    
    
    $(function(){
        $('#ta_desc').keyup(function(){
            limitChars('ta_desc', 300, '');
        });
    });
    
    
    //// just to show correct no. of chracters left while the page is loaded...
    limitChars('ta_desc',300, '');
    
 
});
</script>

<script type="text/javascript">

var ajax_req_feeds = null;
function show_more_records(page) {
	
	if(ajax_req_feeds!=null) {
		ajax_req_feeds.abort();
	}
	showUILoader_nodialog();
	ajax_req_feeds = $.ajax({
		type: 'get',
		url: base_url+'logged/prayer_wall/all_prayer_request_ajax_pagination/'+page,
		dataType: 'json',

		success: function (data, status) {

			hideUILoader_nodialog();
			if(data.html!='') {
				
				//alert(data.cur_page+'dfdf');
				$('#req_content_div').append(data.html);
				$('#show_more_tweets_link').attr('page_value', data.cur_page);
				$('#show_more_tweets_link').attr('onclick','');
				$('#show_more_tweets_link').attr('onclick','show_more_records('+data.cur_page+')');
			}
			else {
				$('#req_content_div').append('<div class="view_more" style="text-align: center;"><p class="blue_bold12" style="font-size:14px;">No More Prayer Request.</p></div>');
				$('#show_more_div').remove();
			}
			//alert(data.view_more);
            
            if(data.view_more==false)
            {
               
                $('#req_content_div').append('<div class="view_more" style="text-align: center;" ><p class="blue_bold12" style="font-size:14px;">No More Prayer Request.</p></div>');
                $('#show_more_div').remove();
            }
		

		}	// end of success function...
	});
}

$(document).ready(function(arg) {
	



 $('#frm_Search').submit(function(){ 
			
		 // var i_user_id = $('#i_user_id').val();			
		  var datatosend=$("#frm_Search").serialize();
		   showUILoader_nodialog('<img src="'+base_url+'images/loading_big.gif" width="50"/> ');
			  $.ajax({
					 type: "POST",
					 url: base_url+'logged/prayer_wall/all_prayer_request_ajax_pagination/',
					 data: datatosend,
					 dataType : 'json',
					 success: function(data){
						//$('#frm_Search')[0].reset();
						
						if(data.html!='') {
							//alert( data.cur_page+' posting');
							$('#show_more_div').remove();
							$('#req_content_div').html(data.html);
							$('#show_more_tweets_link').attr('page_value', data.cur_page);
							$('#show_more_tweets_link').attr('onclick','');
							$('#show_more_tweets_link').attr('onclick','show_more_records('+data.cur_page+')');
						}
						else {
							$('#req_content_div').html('<div class="view_more" style="text-align: center;" ><p class="blue_bold12" style="font-size:14px;">No Prayer Request.</p></div>');
							$('#show_more_div').remove();
						}
						
						
						//alert(data.no_of_result- data.current_page);
						if(data.no_of_result == 0){
							$('#show_more_div').remove();
						}
						else if(data.view_more==false )
						{
							//alert(1);
							$('#req_content_div').append('<div class="view_more" style="text-align: center;"><p class="blue_bold12" style="font-size:14px;">No More Prayer Request.</p></div>');
							$('#show_more_div').remove();
						}
						else if((data.no_of_result - data.cur_page != 0)){
							//alert(2);
							
							$('#show_more_div').remove();
							$('#mid_container').append('<div class="view_more" id="show_more_div"><a href="javascript:void(0);" id="show_more_tweets_link" page_value="'+data.cur_page+'" onclick="show_more_records('+data.cur_page+')">[view more] </a> </div>');
						}
						
						hideUILoader_nodialog();
					 }
			   });	 
	
	});
});
 
</script>